<!doctype html>
<html lang="en" class="scroll-smooth">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{{ title or site.title }}</title>
  <meta name="description" content="{{ description or site.description }}">
  <link rel="stylesheet" href="/assets/main.css">

  <script>
    // Dark by default; respect user choice if light
    const theme = localStorage.getItem('theme');
    if (theme === 'light') document.documentElement.classList.remove('dark');
    else document.documentElement.classList.add('dark');
  </script>

  <style>
    /* === HERO ANIMATIONS === */
    .hero-enter { opacity: 0; transform: translateY(24px); transition: opacity .8s ease-out, transform .8s ease-out; }
    .hero-enter.is-visible { opacity: 1; transform: none; }
    .hero-parallax { will-change: transform; transition: transform 0.1s linear; }
    .hero-bg-pulse { animation: bgPulse 6s ease-in-out infinite alternate; }
    @keyframes bgPulse { from { opacity:.35; transform:scale(1.1);} to { opacity:.45; transform:scale(1.2);} }

    /* Page fade */
    .fade-root { opacity: 0; transition: opacity .45s ease; }
    .fade-root.is-ready { opacity: 1; }

    /* Scroll reveal */
    .reveal { opacity: 0; transform: translateY(12px); transition: opacity .6s ease, transform .6s ease; }
    .reveal.is-visible { opacity: 1; transform: none; }

    /* Hero subtle glow */
    .glow { box-shadow: 0 0 80px rgba(56,189,248,.25), 0 0 160px rgba(56,189,248,.18) inset; }
  </style>

  <script>
    // Fade-in on load & scroll reveal
    document.addEventListener('DOMContentLoaded', () => {
      document.body.classList.add('fade-root','is-ready');
      const io = new IntersectionObserver((entries)=>entries.forEach(e=>{
        if(e.isIntersecting) e.target.classList.add('is-visible');
      }), {threshold:.12});
      document.querySelectorAll('.reveal').forEach(el=>io.observe(el));
    });

    // Fade-out on internal link nav
    document.addEventListener('click', (e)=>{
      const a = e.target.closest('a[href]');
      if(!a) return;
      const url = new URL(a.href, location.href);
      if(url.origin===location.origin && !a.hasAttribute('target') && !a.href.includes('#')) {
        e.preventDefault();
        document.body.classList.remove('is-ready');
        setTimeout(()=>{ location.href=a.href; }, 200);
      }
    });
  </script>
</head>
<script>
  // Reveal hero elements on load (so foreground fades in)
  document.addEventListener('DOMContentLoaded', () => {
    requestAnimationFrame(() => {
      document.querySelectorAll('.hero-enter').forEach(el => el.classList.add('is-visible'));
    });
  });
</script>
<body class="bg-white text-slate-900 dark:bg-slate-900 dark:text-slate-100">
  <div class="max-w-6xl mx-auto px-4">
    {% include "components/header.njk" %}
    <main class="py-10">{{ content | safe }}</main>
    {% include "components/footer.njk" %}
  </div>

  <!-- Optional: tiny parallax helper (page-wide) -->
  <script>
    const hero = document.querySelector('.hero-parallax');
    if (hero) {
      window.addEventListener('scroll', () => {
        const offset = window.scrollY * 0.1;  // tune depth
        hero.style.transform = `translateY(${offset}px)`;
      });
    }
  </script>
</body>
</html>